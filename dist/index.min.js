!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.hybridButterfly=e():t.hybridButterfly=e()}(window,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=10)}([function(t,e,n){"use strict";t.exports=function(){}},function(t,e,n){"use strict";e.__esModule=!0;e.addLeadingSlash=function(t){return"/"===t.charAt(0)?t:"/"+t},e.stripLeadingSlash=function(t){return"/"===t.charAt(0)?t.substr(1):t};var i=e.hasBasename=function(t,e){return new RegExp("^"+e+"(\\/|\\?|#|$)","i").test(t)};e.stripBasename=function(t,e){return i(t,e)?t.substr(e.length):t},e.stripTrailingSlash=function(t){return"/"===t.charAt(t.length-1)?t.slice(0,-1):t},e.parsePath=function(t){var e=t||"/",n="",i="",r=e.indexOf("#");-1!==r&&(i=e.substr(r),e=e.substr(0,r));var o=e.indexOf("?");return-1!==o&&(n=e.substr(o),e=e.substr(0,o)),{pathname:e,search:"?"===n?"":n,hash:"#"===i?"":i}},e.createPath=function(t){var e=t.pathname,n=t.search,i=t.hash,r=e||"/";return n&&"?"!==n&&(r+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(r+="#"===i.charAt(0)?i:"#"+i),r}},function(t,e,n){"use strict";e.__esModule=!0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},o=c(n(0)),s=c(n(4)),a=n(5),h=n(1),l=c(n(8)),u=n(9);function c(t){return t&&t.__esModule?t:{default:t}}var d=function(){try{return window.history.state||{}}catch(t){return{}}};e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,s.default)(u.canUseDOM,"Browser history needs a DOM");var e=window.history,n=(0,u.supportsHistory)(),c=!(0,u.supportsPopStateOnHashChange)(),p=t.forceRefresh,f=void 0!==p&&p,m=t.getUserConfirmation,x=void 0===m?u.getConfirmation:m,g=t.keyLength,v=void 0===g?6:g,w=t.basename?(0,h.stripTrailingSlash)((0,h.addLeadingSlash)(t.basename)):"",y=function(t){var e=t||{},n=e.key,i=e.state,r=window.location,s=r.pathname+r.search+r.hash;return(0,o.default)(!w||(0,h.hasBasename)(s,w),'You are attempting to use a basename on a page whose URL path does not begin with the basename. Expected path "'+s+'" to begin with "'+w+'".'),w&&(s=(0,h.stripBasename)(s,w)),(0,a.createLocation)(s,i,n)},b=function(){return Math.random().toString(36).substr(2,v)},E=(0,l.default)(),M=function(t){r(P,t),P.length=e.length,E.notifyListeners(P.location,P.action)},k=function(t){(0,u.isExtraneousPopstateEvent)(t)||C(y(t.state))},_=function(){C(y(d()))},N=!1,C=function(t){N?(N=!1,M()):E.confirmTransitionTo(t,"POP",x,function(e){e?M({action:"POP",location:t}):$(t)})},$=function(t){var e=P.location,n=L.indexOf(e.key);-1===n&&(n=0);var i=L.indexOf(t.key);-1===i&&(i=0);var r=n-i;r&&(N=!0,A(r))},O=y(d()),L=[O.key],T=function(t){return w+(0,h.createPath)(t)},A=function(t){e.go(t)},S=0,R=function(t){1===(S+=t)?((0,u.addEventListener)(window,"popstate",k),c&&(0,u.addEventListener)(window,"hashchange",_)):0===S&&((0,u.removeEventListener)(window,"popstate",k),c&&(0,u.removeEventListener)(window,"hashchange",_))},j=!1,P={length:e.length,action:"POP",location:O,createHref:T,push:function(t,r){(0,o.default)(!("object"===(void 0===t?"undefined":i(t))&&void 0!==t.state&&void 0!==r),"You should avoid providing a 2nd state argument to push when the 1st argument is a location-like object that already has state; it is ignored");var s=(0,a.createLocation)(t,r,b(),P.location);E.confirmTransitionTo(s,"PUSH",x,function(t){if(t){var i=T(s),r=s.key,a=s.state;if(n)if(e.pushState({key:r,state:a},null,i),f)window.location.href=i;else{var h=L.indexOf(P.location.key),l=L.slice(0,-1===h?0:h+1);l.push(s.key),L=l,M({action:"PUSH",location:s})}else(0,o.default)(void 0===a,"Browser history cannot push state in browsers that do not support HTML5 history"),window.location.href=i}})},replace:function(t,r){(0,o.default)(!("object"===(void 0===t?"undefined":i(t))&&void 0!==t.state&&void 0!==r),"You should avoid providing a 2nd state argument to replace when the 1st argument is a location-like object that already has state; it is ignored");var s=(0,a.createLocation)(t,r,b(),P.location);E.confirmTransitionTo(s,"REPLACE",x,function(t){if(t){var i=T(s),r=s.key,a=s.state;if(n)if(e.replaceState({key:r,state:a},null,i),f)window.location.replace(i);else{var h=L.indexOf(P.location.key);-1!==h&&(L[h]=s.key),M({action:"REPLACE",location:s})}else(0,o.default)(void 0===a,"Browser history cannot replace state in browsers that do not support HTML5 history"),window.location.replace(i)}})},go:A,goBack:function(){return A(-1)},goForward:function(){return A(1)},block:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=E.setPrompt(t);return j||(R(1),j=!0),function(){return j&&(j=!1,R(-1)),e()}},listen:function(t){var e=E.appendListener(t);return R(1),function(){R(-1),e()}}};return P}},function(t,e){t.exports=c,t.exports.parse=o,t.exports.compile=function(t,e){return s(o(t,e))},t.exports.tokensToFunction=s,t.exports.tokensToRegExp=u;var n="/",i="./",r=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function o(t,e){for(var o,s=[],l=0,u=0,c="",d=e&&e.delimiter||n,p=e&&e.delimiters||i,f=!1;null!==(o=r.exec(t));){var m=o[0],x=o[1],g=o.index;if(c+=t.slice(u,g),u=g+m.length,x)c+=x[1],f=!0;else{var v="",w=t[u],y=o[2],b=o[3],E=o[4],M=o[5];if(!f&&c.length){var k=c.length-1;p.indexOf(c[k])>-1&&(v=c[k],c=c.slice(0,k))}c&&(s.push(c),c="",f=!1);var _=""!==v&&void 0!==w&&w!==v,N="+"===M||"*"===M,C="?"===M||"*"===M,$=v||d,O=b||E;s.push({name:y||l++,prefix:v,delimiter:$,optional:C,repeat:N,partial:_,pattern:O?h(O):"[^"+a($)+"]+?"})}}return(c||u<t.length)&&s.push(c+t.substr(u)),s}function s(t){for(var e=new Array(t.length),n=0;n<t.length;n++)"object"==typeof t[n]&&(e[n]=new RegExp("^(?:"+t[n].pattern+")$"));return function(n,i){for(var r="",o=i&&i.encode||encodeURIComponent,s=0;s<t.length;s++){var a=t[s];if("string"!=typeof a){var h,l=n?n[a.name]:void 0;if(Array.isArray(l)){if(!a.repeat)throw new TypeError('Expected "'+a.name+'" to not repeat, but got array');if(0===l.length){if(a.optional)continue;throw new TypeError('Expected "'+a.name+'" to not be empty')}for(var u=0;u<l.length;u++){if(h=o(l[u],a),!e[s].test(h))throw new TypeError('Expected all "'+a.name+'" to match "'+a.pattern+'"');r+=(0===u?a.prefix:a.delimiter)+h}}else if("string"!=typeof l&&"number"!=typeof l&&"boolean"!=typeof l){if(!a.optional)throw new TypeError('Expected "'+a.name+'" to be '+(a.repeat?"an array":"a string"));a.partial&&(r+=a.prefix)}else{if(h=o(String(l),a),!e[s].test(h))throw new TypeError('Expected "'+a.name+'" to match "'+a.pattern+'", but got "'+h+'"');r+=a.prefix+h}}else r+=a}return r}}function a(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function h(t){return t.replace(/([=!:$/()])/g,"\\$1")}function l(t){return t&&t.sensitive?"":"i"}function u(t,e,r){for(var o=(r=r||{}).strict,s=!1!==r.start,h=!1!==r.end,u=a(r.delimiter||n),c=r.delimiters||i,d=[].concat(r.endsWith||[]).map(a).concat("$").join("|"),p=s?"^":"",f=0===t.length,m=0;m<t.length;m++){var x=t[m];if("string"==typeof x)p+=a(x),f=m===t.length-1&&c.indexOf(x[x.length-1])>-1;else{var g=x.repeat?"(?:"+x.pattern+")(?:"+a(x.delimiter)+"(?:"+x.pattern+"))*":x.pattern;e&&e.push(x),x.optional?x.partial?p+=a(x.prefix)+"("+g+")?":p+="(?:"+a(x.prefix)+"("+g+"))?":p+=a(x.prefix)+"("+g+")"}}return h?(o||(p+="(?:"+u+")?"),p+="$"===d?"$":"(?="+d+")"):(o||(p+="(?:"+u+"(?="+d+"))?"),f||(p+="(?="+u+"|"+d+")")),new RegExp(p,l(r))}function c(t,e,n){return t instanceof RegExp?function(t,e){if(!e)return t;var n=t.source.match(/\((?!\?)/g);if(n)for(var i=0;i<n.length;i++)e.push({name:i,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,pattern:null});return t}(t,e):Array.isArray(t)?function(t,e,n){for(var i=[],r=0;r<t.length;r++)i.push(c(t[r],e,n).source);return new RegExp("(?:"+i.join("|")+")",l(n))}(t,e,n):function(t,e,n){return u(o(t,n),e,n)}(t,e,n)}},function(t,e,n){"use strict";t.exports=function(t,e,n,i,r,o,s,a){if(!t){var h;if(void 0===e)h=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,i,r,o,s,a],u=0;(h=new Error(e.replace(/%s/g,function(){return l[u++]}))).name="Invariant Violation"}throw h.framesToPop=1,h}}},function(t,e,n){"use strict";e.__esModule=!0,e.locationsAreEqual=e.createLocation=void 0;var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=a(n(6)),o=a(n(7)),s=n(1);function a(t){return t&&t.__esModule?t:{default:t}}e.createLocation=function(t,e,n,o){var a=void 0;"string"==typeof t?(a=(0,s.parsePath)(t)).state=e:(void 0===(a=i({},t)).pathname&&(a.pathname=""),a.search?"?"!==a.search.charAt(0)&&(a.search="?"+a.search):a.search="",a.hash?"#"!==a.hash.charAt(0)&&(a.hash="#"+a.hash):a.hash="",void 0!==e&&void 0===a.state&&(a.state=e));try{a.pathname=decodeURI(a.pathname)}catch(t){throw t instanceof URIError?new URIError('Pathname "'+a.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):t}return n&&(a.key=n),o?a.pathname?"/"!==a.pathname.charAt(0)&&(a.pathname=(0,r.default)(a.pathname,o.pathname)):a.pathname=o.pathname:a.pathname||(a.pathname="/"),a},e.locationsAreEqual=function(t,e){return t.pathname===e.pathname&&t.search===e.search&&t.hash===e.hash&&t.key===e.key&&(0,o.default)(t.state,e.state)}},function(t,e,n){"use strict";function i(t){return"/"===t.charAt(0)}function r(t,e){for(var n=e,i=n+1,r=t.length;i<r;n+=1,i+=1)t[n]=t[i];t.pop()}n.r(e),e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=t&&t.split("/")||[],o=e&&e.split("/")||[],s=t&&i(t),a=e&&i(e),h=s||a;if(t&&i(t)?o=n:n.length&&(o.pop(),o=o.concat(n)),!o.length)return"/";var l=void 0;if(o.length){var u=o[o.length-1];l="."===u||".."===u||""===u}else l=!1;for(var c=0,d=o.length;d>=0;d--){var p=o[d];"."===p?r(o,d):".."===p?(r(o,d),c++):c&&(r(o,d),c--)}if(!h)for(;c--;c)o.unshift("..");!h||""===o[0]||o[0]&&i(o[0])||o.unshift("");var f=o.join("/");return l&&"/"!==f.substr(-1)&&(f+="/"),f}},function(t,e,n){"use strict";n.r(e);var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.default=function t(e,n){if(e===n)return!0;if(null==e||null==n)return!1;if(Array.isArray(e))return Array.isArray(n)&&e.length===n.length&&e.every(function(e,i){return t(e,n[i])});var r=void 0===e?"undefined":i(e);if(r!==(void 0===n?"undefined":i(n)))return!1;if("object"===r){var o=e.valueOf(),s=n.valueOf();if(o!==e||s!==n)return t(o,s);var a=Object.keys(e),h=Object.keys(n);return a.length===h.length&&a.every(function(i){return t(e[i],n[i])})}return!1}},function(t,e,n){"use strict";e.__esModule=!0;var i=function(t){return t&&t.__esModule?t:{default:t}}(n(0));e.default=function(){var t=null,e=[];return{setPrompt:function(e){return(0,i.default)(null==t,"A history supports only one prompt at a time"),t=e,function(){t===e&&(t=null)}},confirmTransitionTo:function(e,n,r,o){if(null!=t){var s="function"==typeof t?t(e,n):t;"string"==typeof s?"function"==typeof r?r(s,o):((0,i.default)(!1,"A history needs a getUserConfirmation function in order to use a prompt message"),o(!0)):o(!1!==s)}else o(!0)},appendListener:function(t){var n=!0,i=function(){n&&t.apply(void 0,arguments)};return e.push(i),function(){n=!1,e=e.filter(function(t){return t!==i})}},notifyListeners:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];e.forEach(function(t){return t.apply(void 0,n)})}}}},function(t,e,n){"use strict";e.__esModule=!0;e.canUseDOM=!("undefined"==typeof window||!window.document||!window.document.createElement),e.addEventListener=function(t,e,n){return t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)},e.removeEventListener=function(t,e,n){return t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent("on"+e,n)},e.getConfirmation=function(t,e){return e(window.confirm(t))},e.supportsHistory=function(){var t=window.navigator.userAgent;return(-1===t.indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone"))&&(window.history&&"pushState"in window.history)},e.supportsPopStateOnHashChange=function(){return-1===window.navigator.userAgent.indexOf("Trident")},e.supportsGoWithoutReloadUsingHash=function(){return-1===window.navigator.userAgent.indexOf("Firefox")},e.isExtraneousPopstateEvent=function(t){return void 0===t.state&&-1===navigator.userAgent.indexOf("CriOS")}},function(t,e,n){"use strict";function i(t){return document.createElement(t)}function r(t){return document.createTextNode(t)}function o(t,e){for(let n in e)if("_eventsMap"===n)for(let n in e._eventsMap)t.addEventListener(n,e._eventsMap[n]);else t.setAttribute(n,e[n])}function s(){}function a(){}function h(){}function l(){}n.r(e);class u{lex(t,e,n,l,c,d){for(this.text=t||"",this.index=0,this.currentLineNumber=1,this.tokens=[],this.relationsMap=l||[],this.parsingMode=null,this.contextMode=c||null,this.component=e,this.componentName=n,this.currentComponent={name:null,factory:null,children:[],args:[]},this.tagR1=/[a-zA-Z]/,this.tagR2=/-|\d/,this.whiteSpaceR=/\s/,this.forLoopR=/#for(?:\s+)?\((?:\s+)?(.+)(?:\s+)of(?:\s+)(.+)(?:\s+)?\)(?:\s+)?\[/g,this.ifR=/#if(?:\s+)?\((?:\s+)?([\S\s]*?)(?:\s+)?\)(?:\s+)?\[/g,this.escapeChars={b:"\b",f:"\f",n:"\n",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'};this.index<this.text.length;){let e=t[this.index];if(this.tagR1.test(e)){this.parsingMode===s&&this.resovleCurrentComponent(),this.parsingMode=i;let t=this.readTag();this.component&&this.component.components&&this.component.components[t.rawValue]?(this.parsingMode=s,this.currentComponent.factory=this.component.components[t.rawValue],this.currentComponent.name=this.component.components[t.rawValue].name):this.tokens.push(t)}else if(this.whiteSpaceR.test(e))"\n"===e&&(this.currentLineNumber+=1),this.index+=1;else if("["===e){if(!this.tokens.length)throw this.vizError(this.index,this.index+1),new Error(`Can not declare children without a parent: line -> ${this.currentLineNumber}, index -> ${this.index}, char -> ${this.text[this.index]}`);this.relationsMap.push(this.tokens[this.tokens.length-1]),this.contextMode=h,this.index+=1}else if("]"===e)this.parsingMode===s&&this.resovleCurrentComponent(),this.relationsMap.pop(),this.contextMode=this.relationsMap.length?h:null,this.index+=1;else if("'"===e||'"'===e)this.parsingMode===s&&this.resovleCurrentComponent(),this.parsingMode=r,this.tokens.push(this.readText(e));else if("("===e)if(this.parsingMode===s)this.parsingMode=a,this.readComponentArgs(this.currentComponent.args),this.resovleCurrentComponent();else{if(!this.tokens.length)throw this.vizError(this.index,this.index+1),new Error(`Can not attach attrs on null: ${this.contextName?"Component -> "+this.contextName+",":""} line -> ${this.currentLineNumber}, index -> ${this.index}, char -> ${this.text[this.index]}`);this.parsingMode=o,this.tokens[this.tokens.length-1].attrs=this.readAttrs()}else if(","===e)this.index+=1;else if("#"===e){let t;if(this.parsingMode===s&&this.resovleCurrentComponent(),this.forLoopR.lastIndex=this.ifR.lastIndex=this.index,t=this.forLoopR.exec(this.text)){let e=t[1],n=t[2],i=t[0].indexOf(n);this.index+=i;let r=this.readStrExp(n);this.index+=t[0].length-i-n.length;let o=this.index,s=this.getBodyEndIndex(1),a=this.text.slice(o,s),h=-1,l=r();if(!Array.isArray(l))throw new Error(`For loop collection must be an array -> ${n}`);for(let t of l){h+=1,(new u).lex(a,{...this.component,[e]:t,even:h%2==0,odd:h%2!=0,counter:h},this.componentName,this.relationsMap,this.contextMode,!0).forEach(t=>this.tokens.push(t))}}else{if(!(t=this.ifR.exec(this.text)))throw this.vizError(this.index,this.index+5),new Error(`Invalid if/for syntax: ${this.componentName?"Component -> "+this.componentName+",":""} line -> ${this.currentLineNumber}`);{let e=t[1],n=t[0].indexOf(e);this.index+=n;let i=this.readStrExp(e);this.index+=t[0].length-n-e.length;let r=this.index,o=this.getBodyEndIndex(1);if(i()){let t=this.text.slice(r,o);(new u).lex(t,this.component,this.componentName,this.relationsMap,this.contextMode,!0).forEach(t=>this.tokens.push(t))}else this.index=o+1}}}else{if("{"!==e||"{"!==this.peak(1))throw this.vizError(this.index,this.index+1),new Error(`Unknown char: line -> ${this.currentLineNumber}, index -> ${this.index}, char -> ${this.text[this.index]}`);{this.parsingMode===s&&this.resovleCurrentComponent();let{expFunc:t,startIndex:e}=this.readExp();this.tokens.push(this.makeToken(String(t()),e,r))}}}return d||(this.tokens[0].component=this.component),this.tokens.length?this.tokens:[]}readComponentArgs(t){let e=l,n=l,i=this.index;for(this.index+=1;this.parsingMode===a;){let o=this.text[this.index];if(null==o)throw this.vizError(i,this.index),new Error(`Missing a closing parenthesis: ${this.componentName?"Component -> "+this.componentName+",":""} text -> ${this.text.slice(i,this.index)}`);if("'"===o||'"'===o){if(e!==l)throw this.vizError(i,this.index),new Error(`Missing comma: ${this.componentName?"Component -> "+this.componentName+",":""} after -> ${this.text.slice(i,this.index)}`);this.parsingMode=r,e=this.readText(o).rawValue,this.parsingMode=a}else if("{"===o&&"{"===this.peak(1)){if(n!==l)throw this.vizError(i,this.index),new Error(`Missing comma: ${this.componentName?"Component -> "+this.componentName+",":""} after -> ${this.text.slice(i,this.index)}`);let{expFunc:t}=this.readExp();n=t()}else if(","===o||")"===o)this.index+=1,e!==l&&(t.push(e),e=l),n!==l&&(t.push(n),n=l),")"===o&&(this.parsingMode=s);else{if(!this.whiteSpaceR.test(o))throw this.vizError(this.index,this.index+1),new Error(`Unknown char: line -> ${this.currentLineNumber}, index -> ${this.index}, char -> ${this.text[this.index]}`);"\n"===o&&(this.currentLineNumber+=1),this.index+=1}}}resovleCurrentComponent(){let t=this.currentComponent.factory,e=new t(...this.currentComponent.args);if(e._isHybridButterflyComponent){this.fLexer(e,t).forEach(t=>this.tokens.push(t))}this.currentComponent={name:null,factory:null,children:[],args:[]},this.parsingMode=null}fLexer(t,e){return(new u).lex(t.template(),t,e.name,this.relationsMap,this.contextMode)}readStrExp(t){let{expFunc:e}=this.readExp(t.length);return e}getBodyEndIndex(t){for(;t;){let e=this.text[this.index];if(null==e)throw this.vizError(this.index-3,this.index+1),new Error(`Missing a closing bracket: ${this.componentName?"Component -> "+this.componentName+",":""} text -> ${this.text.slice(this.index-3,this.index+1)}`);if("'"===e||'"'===e){let t=this.parsingMode;this.parsingMode=r;let n=this.readText(e);this.parsingMode=t,this.index=n.endIndex+2}else"["===e?(t+=1,this.index+=1):"]"===e?(t-=1,this.index+=1):this.index+=1}return this.index-1}peak(t){return this.text[this.index+t]}readTag(){let t="",e=this.index;for(t+=this.text[this.index],this.index+=1;this.parsingMode===i;){let n=this.text[this.index];if(null==n||!this.tagR1.test(n)&&!this.tagR2.test(n)){let n=this.makeToken(t,e);return t=e=null,this.parsingMode=null,n}t+=n,this.index+=1}}readText(t){let e="",n=t,i=this.index+1,o=!1;for(this.index+=1;this.parsingMode===r;){let t=this.text[this.index];if(null==t)throw this.vizError(i,this.index-1),new Error(`Missing quote: line -> ${this.currentLineNumber}, index -> ${this.index}, text -> ${this.text.slice(i,this.index-1)}`);if(o)e+=this.escapeChars[this.text[this.index]]||t,this.index+=1,o=!1;else if("\\"===t)o=!0,this.index+=1;else{if(t===n){let t=this.makeToken(e,i);return e=i=null,this.index+=1,t}"\n"===t&&(this.currentLineNumber+=1),e+=t,this.index+=1}}}readAttrs(){let t={_eventsMap:{}},e="",n="",i=!0,s=!1,a=!1,h=!1,l=this.index+1;for(this.index+=1;this.parsingMode===o;){let u=this.text[this.index];if(null==u)throw this.vizError(l,this.index),new Error(`Missing a closing parenthesis: ${this.componentName?"Component -> "+this.componentName+",":""} text -> ${this.text.slice(l,this.index)}`);if(this.whiteSpaceR.test(u))e&&(a=!0),"\n"===u&&(this.currentLineNumber+=1),this.index+=1;else if(","===u||")"===u){if(e&&(h?(t._eventsMap[e]=n,h=!1):t[e]=n),e=n="",s=!1,i=!0,a=!1,this.index+=1,")"===u){let i=this.makeToken(t,l);return this.parsingMode=e=n=t=null,i}}else if(i)if("@"===u){if(a)throw this.vizError(l,this.index),new Error(`Missing a comma: ${this.componentName?"Component -> "+this.componentName+",":""} text -> ${this.text.slice(l,this.index)}`);h=!0,this.index+=1}else if(this.tagR1.test(u)||e.length&&this.tagR2.test(u)){if(a)throw this.vizError(l,this.index),new Error(`Missing a comma: ${this.componentName?"Component -> "+this.componentName+",":""} text -> ${this.text.slice(l,this.index)}`);e+=u,this.index+=1}else{if("="!==u)throw this.vizError(this.index,this.index+1),new Error(`Attr keys must not have quotes or curly braces: line -> ${this.currentLineNumber}, index -> ${this.index}, char -> ${this.text[this.index]}`);s=!0,i=!1,a=!1,this.index+=1}else if(s)if("{"===u&&"{"===this.peak(1)){let{expFunc:t}=this.readExp();n=t(),s=!1,i=!1,a=!0}else{if("'"!==u&&'"'!==u)throw this.vizError(this.index,this.index+1),new Error(`Attr values must have quotes or curly braces: line -> ${this.currentLineNumber}, index -> ${this.index}, char -> ${this.text[this.index]}`);{this.parsingMode=r;let t=this.readText(u);if(n=t.rawValue,h){let e=this.index;this.index=t.startIndex;let i=this.readStrExp(n);this.index=e,n=i}s=!1,i=!1,a=!0,this.parsingMode=o}}else if(a)throw this.vizError(l,this.index),new Error(`Missing a comma: ${this.componentName?"Component -> "+this.componentName+",":""} text -> ${this.text.slice(l,this.index)}`)}}readExp(t){let e=this.parsingMode,{startIndex:n,vars:i,exp:r}=this.getResovableVars(t),o=i.map(t=>this.component[t]),s=i.indexOf("event");return this.parsingMode=e,{expFunc:t=>{s>=0&&(o[s]=t);try{return new Function(...i,`return ${r}`)(...o)}catch(t){throw this.vizError(n,this.index),new Error(`${t}`)}},startIndex:n}}getResovableVars(t){let e=[],n="",i=this.index,o=!1,s=!1,a="";for(this.index+=null!=t?0:2;!s&&(null==t||t>0);){let h=this.text[this.index];if(null==h)throw this.vizError(i,this.index),new Error(`Missing closing curly braces: ${this.componentName?"Component -> "+this.componentName+",":""} text -> ${this.text.slice(i,this.index)}`);if("'"===h||'"'===h){this.parsingMode=r;let e=this.readText(h);a+=h+e.rawValue+h,null!=t&&(t-=e.rawValue.length+2)}else if("<>=!|&~[],.()+-/%?:".includes(h)||h>=0||h<0){if(null!=t&&(t-=1),a+=h,o="."===h,n)if("false"===n||"true"===n||"NaN"===n||"null"===n||"undefined"===n)n="";else{let t=n.trim();-1===e.indexOf(t)&&e.push(t),n=""}this.index+=1}else if("}"===h&&"}"===this.peak(1)){if(n)if("false"===n||"true"===n||"NaN"===n||"null"===n||"undefined"===n)n="";else{let t=n.trim();-1===e.indexOf(t)&&e.push(t),n=""}s=!0,this.index+=2}else{if("}"===h)throw this.vizError(i,this.index+1),new Error(`Missing closing curly braces: ${this.componentName?"Component -> "+this.componentName+",":""} text -> ${this.text.slice(i,this.index+1)}`);o?(null!=t&&(t-=1),a+=h,this.index+=1):(null!=t&&(t-=1),n+=h,a+=h,this.index+=1)}}if(n)if("false"===n||"true"===n||"NaN"===n||"null"===n||"undefined"===n)n="";else{let t=n.trim();-1===e.indexOf(t)&&e.push(t),n=""}return{startIndex:i,vars:e,exp:a}}makeToken(t,e,n){return{parsingMode:n||this.parsingMode,contextMode:this.contextMode,rawValue:t,startIndex:e,endIndex:this.index-1,lineNumber:this.currentLineNumber,parentToken:this.contextMode===h?this.relationsMap[this.relationsMap.length-1]:null,componentName:this.componentName,attrs:null,component:null}}vizError(t,e){let n;if("object"==typeof document&&(n=document.querySelector("body"))){let i=`<pre>${this.text.slice(0,t)}<b style="color:orangered">${this.text.slice(t,e)}</b></pre>`;n.innerHTML=i}}}var c=n(2),d={didMounts:[],willUnmounts:[],appInstance:null,history:n.n(c)()()};class p{build(t=[]){if(this.tokens=t,this.vnt=[],this.tokensLength=this.tokens.length,this.tokensLength>0)return this.tokens.forEach(t=>{if(t.parentToken){let e=t.parentToken.children;e?e.push(t):t.parentToken.children=[t]}else this.vnt.push(t)}),this.vnt.length>1?this.vnt:this.vnt[0];throw new Error("VNT error: not enough tokens")}compile(t){if("[object Object]"===Object.prototype.toString.call(t))return this._compile(t);if("[object Array]"===Object.prototype.toString.call(t))throw new Error("VNT error: got more than 1 entry point")}_compile({rawValue:t,attrs:e,children:n,parsingMode:r,component:s}){let a=r(t);return s&&(s._setDOM(a),a._component=s,"function"==typeof s.didMount&&d.didMounts.push(s.didMount.bind(s))),r===i&&(a._tag=t),e?(o(a,e.rawValue),a._attrs=e.rawValue):a._attrs={},n&&n.forEach(t=>a.appendChild(this._compile(t))),a}}let f=function(t){return function(e){return t._compile(e)}}(new p);function m(){if(d.didMounts.length){let t=d.didMounts.slice();d.didMounts=[],t.forEach(t=>t())}}function x(t,e){g(t),function(){if(d.willUnmounts.length){let t=d.willUnmounts.slice();d.willUnmounts=[];for(let e=t.length-1;e>-1;e--)t[e]()}}(),e||t.remove()}function g(t){if(3!==t.nodeType)return 1===t.nodeType&&!t._component&&t.childNodes.length?v(t.childNodes):void(1===t.nodeType&&t._component&&t._component.willUnmount&&(d.willUnmounts.push(t._component.willUnmount.bind(t._component)),t.childNodes.length&&v(t.childNodes)))}function v(t){let e=0,n=t.length;for(;e<n;)g(t[e]),e++}function w(t,e,n){let i=f(t);return x(e,!0),n.replaceChild(i,e),i}function y(t,e){if("function"==typeof t){let n;if(n=new t,d.appInstance=n,!n._isHybridButterflyComponent)throw new Error(`${t.name} must extend Component`);let i=new u,r=new p;if(!e||!e||!e.appendChild)throw new Error("render second argument must be a DOM element");return e.appendChild(r.compile(r.build(i.lex(n.template(),n,t.name)))),void m()}throw new Error("render first argument must be a class/constructor")}function b(){this.components={},this._isHybridButterflyComponent=!0}b.prototype.updateView=function(){let t=new u,e=new p,n=this.template();!function t(e,n,i){if(n&&null!=e)if(1===n.nodeType){if(e.rawValue!==n._tag)return w(e,n,i);{if(e.component&&n._component){if(e.component.constructor.name!==n._component.constructor.name)return w(e,n,i);n._component=Object.assign(e.component,n._component),n._component._setDOM(n)}else if(e.component||n._component)return w(e,n,i);if(function(t,e){let n=t.attrs?t.attrs.rawValue:{};!function(t,e,n){for(let i in e)if("_eventsMap"===i)for(let t in e._eventsMap)n.removeEventListener(t,e._eventsMap[t]);else i in t||n.removeAttribute(i)}(n,e._attrs,e),function(t,e,n){for(let i in t)if("_eventsMap"===i)for(let e in t._eventsMap)n.addEventListener(e,t._eventsMap[e]);else e[i]!==t[i]&&n.setAttribute(i,t[i])}(n,e._attrs,e),e._attrs=n}(e,n),e.children)for(let i=0;i<e.children.length;i++)t(e.children[i],n.childNodes[i],n);let r=n.childNodes.length,o=e.children?e.children.length:0;if(r>o)for(;r-- >o;)x(n.childNodes[r])}}else{if(3!==n.nodeType||e.parsingMode!==r)return w(e,n,i);e.rawValue!==n.nodeValue&&(n.nodeValue=e.rawValue)}else null==n&&e&&i.appendChild(f(e))}(e.build(t.lex(n,this,this.constructor.name)),this.DOM,this.DOM.parentNode),m()},b.prototype._setRouterMatch=function(t){this.routerMatch=t},b.prototype._setDOM=function(t){this.DOM=t};var E=n(3),M=n.n(E);d.history.listen(()=>{d.appInstance.updateView()});class k{constructor({path:t,component:e,exact:n,data:i}){let r=d.history.location.pathname,o=[],s=M()(t,o).exec(r);if(s){let t;if(s.length>1){let e=o.map(t=>t.name),n=s.slice(1);t=e.reduce((t,e,i)=>(t[e]=n[i],t),{})}let n=new e(i);return n._setRouterMatch(t),n}return r.startsWith(t)&&!n?new e(i):{}}}class _ extends b{constructor(t,e){super(),this.text=t,this.path=e,this.navigate=this.navigate.bind(this)}navigate(){d.history.push(this.path)}template(){return`a(href="javascript:;",@click="navigate()")["${this.text}"]`}}n.d(e,"Component",function(){return b}),n.d(e,"render",function(){return y}),n.d(e,"RouterLink",function(){return _}),n.d(e,"RouterView",function(){return k})}])});