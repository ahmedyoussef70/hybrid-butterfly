!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.hybridButterfly=e():t.hybridButterfly=e()}(window,function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=10)}([function(t,e,n){"use strict";t.exports=function(){}},function(t,e,n){"use strict";e.__esModule=!0;e.addLeadingSlash=function(t){return"/"===t.charAt(0)?t:"/"+t},e.stripLeadingSlash=function(t){return"/"===t.charAt(0)?t.substr(1):t};var i=e.hasBasename=function(t,e){return new RegExp("^"+e+"(\\/|\\?|#|$)","i").test(t)};e.stripBasename=function(t,e){return i(t,e)?t.substr(e.length):t},e.stripTrailingSlash=function(t){return"/"===t.charAt(t.length-1)?t.slice(0,-1):t},e.parsePath=function(t){var e=t||"/",n="",i="",r=e.indexOf("#");-1!==r&&(i=e.substr(r),e=e.substr(0,r));var o=e.indexOf("?");return-1!==o&&(n=e.substr(o),e=e.substr(0,o)),{pathname:e,search:"?"===n?"":n,hash:"#"===i?"":i}},e.createPath=function(t){var e=t.pathname,n=t.search,i=t.hash,r=e||"/";return n&&"?"!==n&&(r+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(r+="#"===i.charAt(0)?i:"#"+i),r}},function(t,e,n){"use strict";e.__esModule=!0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},o=l(n(0)),s=l(n(4)),a=n(5),h=n(1),u=l(n(8)),c=n(9);function l(t){return t&&t.__esModule?t:{default:t}}var d=function(){try{return window.history.state||{}}catch(t){return{}}};e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,s.default)(c.canUseDOM,"Browser history needs a DOM");var e=window.history,n=(0,c.supportsHistory)(),l=!(0,c.supportsPopStateOnHashChange)(),f=t.forceRefresh,p=void 0!==f&&f,m=t.getUserConfirmation,x=void 0===m?c.getConfirmation:m,v=t.keyLength,g=void 0===v?6:v,y=t.basename?(0,h.stripTrailingSlash)((0,h.addLeadingSlash)(t.basename)):"",w=function(t){var e=t||{},n=e.key,i=e.state,r=window.location,s=r.pathname+r.search+r.hash;return(0,o.default)(!y||(0,h.hasBasename)(s,y),'You are attempting to use a basename on a page whose URL path does not begin with the basename. Expected path "'+s+'" to begin with "'+y+'".'),y&&(s=(0,h.stripBasename)(s,y)),(0,a.createLocation)(s,i,n)},b=function(){return Math.random().toString(36).substr(2,g)},E=(0,u.default)(),M=function(t){r(V,t),V.length=e.length,E.notifyListeners(V.location,V.action)},k=function(t){(0,c.isExtraneousPopstateEvent)(t)||N(w(t.state))},_=function(){N(w(d()))},O=!1,N=function(t){O?(O=!1,M()):E.confirmTransitionTo(t,"POP",x,function(e){e?M({action:"POP",location:t}):C(t)})},C=function(t){var e=V.location,n=T.indexOf(e.key);-1===n&&(n=0);var i=T.indexOf(t.key);-1===i&&(i=0);var r=n-i;r&&(O=!0,S(r))},L=w(d()),T=[L.key],A=function(t){return y+(0,h.createPath)(t)},S=function(t){e.go(t)},R=0,j=function(t){1===(R+=t)?((0,c.addEventListener)(window,"popstate",k),l&&(0,c.addEventListener)(window,"hashchange",_)):0===R&&((0,c.removeEventListener)(window,"popstate",k),l&&(0,c.removeEventListener)(window,"hashchange",_))},P=!1,V={length:e.length,action:"POP",location:L,createHref:A,push:function(t,r){(0,o.default)(!("object"===(void 0===t?"undefined":i(t))&&void 0!==t.state&&void 0!==r),"You should avoid providing a 2nd state argument to push when the 1st argument is a location-like object that already has state; it is ignored");var s=(0,a.createLocation)(t,r,b(),V.location);E.confirmTransitionTo(s,"PUSH",x,function(t){if(t){var i=A(s),r=s.key,a=s.state;if(n)if(e.pushState({key:r,state:a},null,i),p)window.location.href=i;else{var h=T.indexOf(V.location.key),u=T.slice(0,-1===h?0:h+1);u.push(s.key),T=u,M({action:"PUSH",location:s})}else(0,o.default)(void 0===a,"Browser history cannot push state in browsers that do not support HTML5 history"),window.location.href=i}})},replace:function(t,r){(0,o.default)(!("object"===(void 0===t?"undefined":i(t))&&void 0!==t.state&&void 0!==r),"You should avoid providing a 2nd state argument to replace when the 1st argument is a location-like object that already has state; it is ignored");var s=(0,a.createLocation)(t,r,b(),V.location);E.confirmTransitionTo(s,"REPLACE",x,function(t){if(t){var i=A(s),r=s.key,a=s.state;if(n)if(e.replaceState({key:r,state:a},null,i),p)window.location.replace(i);else{var h=T.indexOf(V.location.key);-1!==h&&(T[h]=s.key),M({action:"REPLACE",location:s})}else(0,o.default)(void 0===a,"Browser history cannot replace state in browsers that do not support HTML5 history"),window.location.replace(i)}})},go:S,goBack:function(){return S(-1)},goForward:function(){return S(1)},block:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=E.setPrompt(t);return P||(j(1),P=!0),function(){return P&&(P=!1,j(-1)),e()}},listen:function(t){var e=E.appendListener(t);return j(1),function(){j(-1),e()}}};return V}},function(t,e){t.exports=l,t.exports.parse=o,t.exports.compile=function(t,e){return s(o(t,e))},t.exports.tokensToFunction=s,t.exports.tokensToRegExp=c;var n="/",i="./",r=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function o(t,e){for(var o,s=[],u=0,c=0,l="",d=e&&e.delimiter||n,f=e&&e.delimiters||i,p=!1;null!==(o=r.exec(t));){var m=o[0],x=o[1],v=o.index;if(l+=t.slice(c,v),c=v+m.length,x)l+=x[1],p=!0;else{var g="",y=t[c],w=o[2],b=o[3],E=o[4],M=o[5];if(!p&&l.length){var k=l.length-1;f.indexOf(l[k])>-1&&(g=l[k],l=l.slice(0,k))}l&&(s.push(l),l="",p=!1);var _=""!==g&&void 0!==y&&y!==g,O="+"===M||"*"===M,N="?"===M||"*"===M,C=g||d,L=b||E;s.push({name:w||u++,prefix:g,delimiter:C,optional:N,repeat:O,partial:_,pattern:L?h(L):"[^"+a(C)+"]+?"})}}return(l||c<t.length)&&s.push(l+t.substr(c)),s}function s(t){for(var e=new Array(t.length),n=0;n<t.length;n++)"object"==typeof t[n]&&(e[n]=new RegExp("^(?:"+t[n].pattern+")$"));return function(n,i){for(var r="",o=i&&i.encode||encodeURIComponent,s=0;s<t.length;s++){var a=t[s];if("string"!=typeof a){var h,u=n?n[a.name]:void 0;if(Array.isArray(u)){if(!a.repeat)throw new TypeError('Expected "'+a.name+'" to not repeat, but got array');if(0===u.length){if(a.optional)continue;throw new TypeError('Expected "'+a.name+'" to not be empty')}for(var c=0;c<u.length;c++){if(h=o(u[c],a),!e[s].test(h))throw new TypeError('Expected all "'+a.name+'" to match "'+a.pattern+'"');r+=(0===c?a.prefix:a.delimiter)+h}}else if("string"!=typeof u&&"number"!=typeof u&&"boolean"!=typeof u){if(!a.optional)throw new TypeError('Expected "'+a.name+'" to be '+(a.repeat?"an array":"a string"));a.partial&&(r+=a.prefix)}else{if(h=o(String(u),a),!e[s].test(h))throw new TypeError('Expected "'+a.name+'" to match "'+a.pattern+'", but got "'+h+'"');r+=a.prefix+h}}else r+=a}return r}}function a(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function h(t){return t.replace(/([=!:$/()])/g,"\\$1")}function u(t){return t&&t.sensitive?"":"i"}function c(t,e,r){for(var o=(r=r||{}).strict,s=!1!==r.start,h=!1!==r.end,c=a(r.delimiter||n),l=r.delimiters||i,d=[].concat(r.endsWith||[]).map(a).concat("$").join("|"),f=s?"^":"",p=0===t.length,m=0;m<t.length;m++){var x=t[m];if("string"==typeof x)f+=a(x),p=m===t.length-1&&l.indexOf(x[x.length-1])>-1;else{var v=x.repeat?"(?:"+x.pattern+")(?:"+a(x.delimiter)+"(?:"+x.pattern+"))*":x.pattern;e&&e.push(x),x.optional?x.partial?f+=a(x.prefix)+"("+v+")?":f+="(?:"+a(x.prefix)+"("+v+"))?":f+=a(x.prefix)+"("+v+")"}}return h?(o||(f+="(?:"+c+")?"),f+="$"===d?"$":"(?="+d+")"):(o||(f+="(?:"+c+"(?="+d+"))?"),p||(f+="(?="+c+"|"+d+")")),new RegExp(f,u(r))}function l(t,e,n){return t instanceof RegExp?function(t,e){if(!e)return t;var n=t.source.match(/\((?!\?)/g);if(n)for(var i=0;i<n.length;i++)e.push({name:i,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,pattern:null});return t}(t,e):Array.isArray(t)?function(t,e,n){for(var i=[],r=0;r<t.length;r++)i.push(l(t[r],e,n).source);return new RegExp("(?:"+i.join("|")+")",u(n))}(t,e,n):function(t,e,n){return c(o(t,n),e,n)}(t,e,n)}},function(t,e,n){"use strict";t.exports=function(t,e,n,i,r,o,s,a){if(!t){var h;if(void 0===e)h=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,i,r,o,s,a],c=0;(h=new Error(e.replace(/%s/g,function(){return u[c++]}))).name="Invariant Violation"}throw h.framesToPop=1,h}}},function(t,e,n){"use strict";e.__esModule=!0,e.locationsAreEqual=e.createLocation=void 0;var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},r=a(n(6)),o=a(n(7)),s=n(1);function a(t){return t&&t.__esModule?t:{default:t}}e.createLocation=function(t,e,n,o){var a=void 0;"string"==typeof t?(a=(0,s.parsePath)(t)).state=e:(void 0===(a=i({},t)).pathname&&(a.pathname=""),a.search?"?"!==a.search.charAt(0)&&(a.search="?"+a.search):a.search="",a.hash?"#"!==a.hash.charAt(0)&&(a.hash="#"+a.hash):a.hash="",void 0!==e&&void 0===a.state&&(a.state=e));try{a.pathname=decodeURI(a.pathname)}catch(t){throw t instanceof URIError?new URIError('Pathname "'+a.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):t}return n&&(a.key=n),o?a.pathname?"/"!==a.pathname.charAt(0)&&(a.pathname=(0,r.default)(a.pathname,o.pathname)):a.pathname=o.pathname:a.pathname||(a.pathname="/"),a},e.locationsAreEqual=function(t,e){return t.pathname===e.pathname&&t.search===e.search&&t.hash===e.hash&&t.key===e.key&&(0,o.default)(t.state,e.state)}},function(t,e,n){"use strict";function i(t){return"/"===t.charAt(0)}function r(t,e){for(var n=e,i=n+1,r=t.length;i<r;n+=1,i+=1)t[n]=t[i];t.pop()}n.r(e),e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=t&&t.split("/")||[],o=e&&e.split("/")||[],s=t&&i(t),a=e&&i(e),h=s||a;if(t&&i(t)?o=n:n.length&&(o.pop(),o=o.concat(n)),!o.length)return"/";var u=void 0;if(o.length){var c=o[o.length-1];u="."===c||".."===c||""===c}else u=!1;for(var l=0,d=o.length;d>=0;d--){var f=o[d];"."===f?r(o,d):".."===f?(r(o,d),l++):l&&(r(o,d),l--)}if(!h)for(;l--;l)o.unshift("..");!h||""===o[0]||o[0]&&i(o[0])||o.unshift("");var p=o.join("/");return u&&"/"!==p.substr(-1)&&(p+="/"),p}},function(t,e,n){"use strict";n.r(e);var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.default=function t(e,n){if(e===n)return!0;if(null==e||null==n)return!1;if(Array.isArray(e))return Array.isArray(n)&&e.length===n.length&&e.every(function(e,i){return t(e,n[i])});var r=void 0===e?"undefined":i(e);if(r!==(void 0===n?"undefined":i(n)))return!1;if("object"===r){var o=e.valueOf(),s=n.valueOf();if(o!==e||s!==n)return t(o,s);var a=Object.keys(e),h=Object.keys(n);return a.length===h.length&&a.every(function(i){return t(e[i],n[i])})}return!1}},function(t,e,n){"use strict";e.__esModule=!0;var i=function(t){return t&&t.__esModule?t:{default:t}}(n(0));e.default=function(){var t=null,e=[];return{setPrompt:function(e){return(0,i.default)(null==t,"A history supports only one prompt at a time"),t=e,function(){t===e&&(t=null)}},confirmTransitionTo:function(e,n,r,o){if(null!=t){var s="function"==typeof t?t(e,n):t;"string"==typeof s?"function"==typeof r?r(s,o):((0,i.default)(!1,"A history needs a getUserConfirmation function in order to use a prompt message"),o(!0)):o(!1!==s)}else o(!0)},appendListener:function(t){var n=!0,i=function(){n&&t.apply(void 0,arguments)};return e.push(i),function(){n=!1,e=e.filter(function(t){return t!==i})}},notifyListeners:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];e.forEach(function(t){return t.apply(void 0,n)})}}}},function(t,e,n){"use strict";e.__esModule=!0;e.canUseDOM=!("undefined"==typeof window||!window.document||!window.document.createElement),e.addEventListener=function(t,e,n){return t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)},e.removeEventListener=function(t,e,n){return t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent("on"+e,n)},e.getConfirmation=function(t,e){return e(window.confirm(t))},e.supportsHistory=function(){var t=window.navigator.userAgent;return(-1===t.indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone"))&&(window.history&&"pushState"in window.history)},e.supportsPopStateOnHashChange=function(){return-1===window.navigator.userAgent.indexOf("Trident")},e.supportsGoWithoutReloadUsingHash=function(){return-1===window.navigator.userAgent.indexOf("Firefox")},e.isExtraneousPopstateEvent=function(t){return void 0===t.state&&-1===navigator.userAgent.indexOf("CriOS")}},function(t,e,n){"use strict";function i(t){return document.createElement(t)}function r(t){return document.createTextNode(t)}function o(t,e){for(var n in e)if("_eventsMap"===n)for(var i in e._eventsMap)t.addEventListener(i,e._eventsMap[i]);else t.setAttribute(n,e[n])}function s(){}function a(){}function h(){}function u(){}function c(t,e,n){return(c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var r=new(Function.bind.apply(t,i));return n&&l(r,n.prototype),r}).apply(null,arguments)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(){return(d=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}n.r(e);var f=function(){function t(){}var e=t.prototype;return e.lex=function(e,n,u,c,l,f){var p=this;for(this.text=e||"",this.index=0,this.currentLineNumber=1,this.tokens=[],this.relationsMap=c||[],this.parsingMode=null,this.contextMode=l||null,this.component=n,this.componentName=u,this.currentComponent={name:null,factory:null,children:[],args:[]},this.tagR1=/[a-zA-Z]/,this.tagR2=/-|\d/,this.whiteSpaceR=/\s/,this.forLoopR=/#for(?:\s+)?\((?:\s+)?(.+)(?:\s+)of(?:\s+)(.+)(?:\s+)?\)(?:\s+)?\[/g,this.ifR=/#if(?:\s+)?\((?:\s+)?([\S\s]*?)(?:\s+)?\)(?:\s+)?\[/g,this.escapeChars={b:"\b",f:"\f",n:"\n",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'};this.index<this.text.length;){var m=e[this.index];if(this.tagR1.test(m)){this.parsingMode===s&&this.resovleCurrentComponent(),this.parsingMode=i;var x=this.readTag();this.component&&this.component.components&&this.component.components[x.rawValue]?(this.parsingMode=s,this.currentComponent.factory=this.component.components[x.rawValue],this.currentComponent.name=this.component.components[x.rawValue].name):this.tokens.push(x)}else if(this.whiteSpaceR.test(m))"\n"===m&&(this.currentLineNumber+=1),this.index+=1;else if("["===m){if(!this.tokens.length)throw this.vizError(this.index,this.index+1),new Error("Can not declare children without a parent: line -> "+this.currentLineNumber+", index -> "+this.index+", char -> "+this.text[this.index]);this.relationsMap.push(this.tokens[this.tokens.length-1]),this.contextMode=h,this.index+=1}else if("]"===m)this.parsingMode===s&&this.resovleCurrentComponent(),this.relationsMap.pop(),this.contextMode=this.relationsMap.length?h:null,this.index+=1;else if("'"===m||'"'===m)this.parsingMode===s&&this.resovleCurrentComponent(),this.parsingMode=r,this.tokens.push(this.readText(m));else if("("===m)if(this.parsingMode===s)this.parsingMode=a,this.readComponentArgs(this.currentComponent.args),this.resovleCurrentComponent();else{if(!this.tokens.length)throw this.vizError(this.index,this.index+1),new Error("Can not attach attrs on null: "+(this.contextName?"Component -> "+this.contextName+",":"")+" line -> "+this.currentLineNumber+", index -> "+this.index+", char -> "+this.text[this.index]);this.parsingMode=o,this.tokens[this.tokens.length-1].attrs=this.readAttrs()}else if(","===m)this.index+=1;else if("#"===m){this.parsingMode===s&&this.resovleCurrentComponent(),this.forLoopR.lastIndex=this.ifR.lastIndex=this.index;var v=void 0;if(v=this.forLoopR.exec(this.text)){var g=v[1],y=v[2],w=v[0].indexOf(y);this.index+=w;var b=this.readStrExp(y);this.index+=v[0].length-w-y.length;var E=this.index,M=this.getBodyEndIndex(1),k=this.text.slice(E,M),_=-1,O=b();if(!Array.isArray(O))throw new Error("For loop collection must be an array -> "+y);var N=O,C=Array.isArray(N),L=0;for(N=C?N:N[Symbol.iterator]();;){var T,A;if(C){if(L>=N.length)break;A=N[L++]}else{if((L=N.next()).done)break;A=L.value}var S=A;_+=1,(new t).lex(k,d({},this.component,((T={})[g]=S,T.even=_%2==0,T.odd=_%2!=0,T.counter=_,T)),this.componentName,this.relationsMap,this.contextMode,!0).forEach(function(t){return p.tokens.push(t)})}}else{if(!(v=this.ifR.exec(this.text)))throw this.vizError(this.index,this.index+5),new Error("Invalid if/for syntax: "+(this.componentName?"Component -> "+this.componentName+",":"")+" line -> "+this.currentLineNumber);var R=v[1],j=v[0].indexOf(R);this.index+=j;var P=this.readStrExp(R);this.index+=v[0].length-j-R.length;var V=this.index,I=this.getBodyEndIndex(1);if(P()){var z=this.text.slice(V,I);(new t).lex(z,this.component,this.componentName,this.relationsMap,this.contextMode,!0).forEach(function(t){return p.tokens.push(t)})}else this.index=I+1}}else{if("{"!==m||"{"!==this.peak(1))throw this.vizError(this.index,this.index+1),new Error("Unknown char: line -> "+this.currentLineNumber+", index -> "+this.index+", char -> "+this.text[this.index]);this.parsingMode===s&&this.resovleCurrentComponent();var U=this.readExp(),B=U.expFunc,H=U.startIndex;this.tokens.push(this.makeToken(String(B()),H,r))}}return f||(this.tokens[0].component=this.component),this.tokens.length?this.tokens:[]},e.readComponentArgs=function(t){var e=u,n=u,i=this.index;for(this.index+=1;this.parsingMode===a;){var o=this.text[this.index];if(null==o)throw this.vizError(i,this.index),new Error("Missing a closing parenthesis: "+(this.componentName?"Component -> "+this.componentName+",":"")+" text -> "+this.text.slice(i,this.index));if("'"===o||'"'===o){if(e!==u)throw this.vizError(i,this.index),new Error("Missing comma: "+(this.componentName?"Component -> "+this.componentName+",":"")+" after -> "+this.text.slice(i,this.index));this.parsingMode=r,e=this.readText(o).rawValue,this.parsingMode=a}else if("{"===o&&"{"===this.peak(1)){if(n!==u)throw this.vizError(i,this.index),new Error("Missing comma: "+(this.componentName?"Component -> "+this.componentName+",":"")+" after -> "+this.text.slice(i,this.index));n=(0,this.readExp().expFunc)()}else if(","===o||")"===o)this.index+=1,e!==u&&(t.push(e),e=u),n!==u&&(t.push(n),n=u),")"===o&&(this.parsingMode=s);else{if(!this.whiteSpaceR.test(o))throw this.vizError(this.index,this.index+1),new Error("Unknown char: line -> "+this.currentLineNumber+", index -> "+this.index+", char -> "+this.text[this.index]);"\n"===o&&(this.currentLineNumber+=1),this.index+=1}}},e.resovleCurrentComponent=function(){var t=this,e=this.currentComponent.factory,n=c(e,this.currentComponent.args);n._isHybridButterflyComponent&&this.fLexer(n,e).forEach(function(e){return t.tokens.push(e)});this.currentComponent={name:null,factory:null,children:[],args:[]},this.parsingMode=null},e.fLexer=function(e,n){return(new t).lex(e.template(),e,n.name,this.relationsMap,this.contextMode)},e.readStrExp=function(t){return this.readExp(t.length).expFunc},e.getBodyEndIndex=function(t){for(;t;){var e=this.text[this.index];if(null==e)throw this.vizError(this.index-3,this.index+1),new Error("Missing a closing bracket: "+(this.componentName?"Component -> "+this.componentName+",":"")+" text -> "+this.text.slice(this.index-3,this.index+1));if("'"===e||'"'===e){var n=this.parsingMode;this.parsingMode=r;var i=this.readText(e);this.parsingMode=n,this.index=i.endIndex+2}else"["===e?(t+=1,this.index+=1):"]"===e?(t-=1,this.index+=1):this.index+=1}return this.index-1},e.peak=function(t){return this.text[this.index+t]},e.readTag=function(){var t="",e=this.index;for(t+=this.text[this.index],this.index+=1;this.parsingMode===i;){var n=this.text[this.index];if(null==n||!this.tagR1.test(n)&&!this.tagR2.test(n)){var r=this.makeToken(t,e);return t=e=null,this.parsingMode=null,r}t+=n,this.index+=1}},e.readText=function(t){var e="",n=t,i=this.index+1,o=!1;for(this.index+=1;this.parsingMode===r;){var s=this.text[this.index];if(null==s)throw this.vizError(i,this.index-1),new Error("Missing quote: line -> "+this.currentLineNumber+", index -> "+this.index+", text -> "+this.text.slice(i,this.index-1));if(o)e+=this.escapeChars[this.text[this.index]]||s,this.index+=1,o=!1;else if("\\"===s)o=!0,this.index+=1;else{if(s===n){var a=this.makeToken(e,i);return e=i=null,this.index+=1,a}"\n"===s&&(this.currentLineNumber+=1),e+=s,this.index+=1}}},e.readAttrs=function(){var t={_eventsMap:{}},e="",n="",i=!0,s=!1,a=!1,h=!1,u=this.index+1;for(this.index+=1;this.parsingMode===o;){var c=this.text[this.index];if(null==c)throw this.vizError(u,this.index),new Error("Missing a closing parenthesis: "+(this.componentName?"Component -> "+this.componentName+",":"")+" text -> "+this.text.slice(u,this.index));if(this.whiteSpaceR.test(c))e&&(a=!0),"\n"===c&&(this.currentLineNumber+=1),this.index+=1;else if(","===c||")"===c){if(e&&(h?(t._eventsMap[e]=n,h=!1):t[e]=n),e=n="",s=!1,i=!0,a=!1,this.index+=1,")"===c){var l=this.makeToken(t,u);return this.parsingMode=e=n=t=null,l}}else if(i)if("@"===c){if(a)throw this.vizError(u,this.index),new Error("Missing a comma: "+(this.componentName?"Component -> "+this.componentName+",":"")+" text -> "+this.text.slice(u,this.index));h=!0,this.index+=1}else if(this.tagR1.test(c)||e.length&&this.tagR2.test(c)){if(a)throw this.vizError(u,this.index),new Error("Missing a comma: "+(this.componentName?"Component -> "+this.componentName+",":"")+" text -> "+this.text.slice(u,this.index));e+=c,this.index+=1}else{if("="!==c)throw this.vizError(this.index,this.index+1),new Error("Attr keys must not have quotes or curly braces: line -> "+this.currentLineNumber+", index -> "+this.index+", char -> "+this.text[this.index]);s=!0,i=!1,a=!1,this.index+=1}else if(s)if("{"===c&&"{"===this.peak(1)){n=(0,this.readExp().expFunc)(),s=!1,i=!1,a=!0}else{if("'"!==c&&'"'!==c)throw this.vizError(this.index,this.index+1),new Error("Attr values must have quotes or curly braces: line -> "+this.currentLineNumber+", index -> "+this.index+", char -> "+this.text[this.index]);this.parsingMode=r;var d=this.readText(c);if(n=d.rawValue,h){var f=this.index;this.index=d.startIndex;var p=this.readStrExp(n);this.index=f,n=p}s=!1,i=!1,a=!0,this.parsingMode=o}else if(a)throw this.vizError(u,this.index),new Error("Missing a comma: "+(this.componentName?"Component -> "+this.componentName+",":"")+" text -> "+this.text.slice(u,this.index))}},e.readExp=function(t){var e=this,n=this.parsingMode,i=this.getResovableVars(t),r=i.startIndex,o=i.vars,s=i.exp,a=o.map(function(t){return e.component[t]}),h=o.indexOf("event");return this.parsingMode=n,{expFunc:function(t){h>=0&&(a[h]=t);try{return c(Function,o.concat(["return "+s])).apply(void 0,a)}catch(t){throw e.vizError(r,e.index),new Error(""+t)}},startIndex:r}},e.getResovableVars=function(t){var e=[],n="",i=this.index,o=!1,s=!1,a="";for(this.index+=null!=t?0:2;!s&&(null==t||t>0);){var h=this.text[this.index];if(null==h)throw this.vizError(i,this.index),new Error("Missing closing curly braces: "+(this.componentName?"Component -> "+this.componentName+",":"")+" text -> "+this.text.slice(i,this.index));if("'"===h||'"'===h){this.parsingMode=r;var u=this.readText(h);a+=h+u.rawValue+h,null!=t&&(t-=u.rawValue.length+2)}else if("<>=!|&~[],.()+-/%?:".includes(h)||h>=0||h<0){if(null!=t&&(t-=1),a+=h,o="."===h,n)if("false"===n||"true"===n||"NaN"===n||"null"===n||"undefined"===n)n="";else{var c=n.trim();-1===e.indexOf(c)&&e.push(c),n=""}this.index+=1}else if("}"===h&&"}"===this.peak(1)){if(n)if("false"===n||"true"===n||"NaN"===n||"null"===n||"undefined"===n)n="";else{var l=n.trim();-1===e.indexOf(l)&&e.push(l),n=""}s=!0,this.index+=2}else{if("}"===h)throw this.vizError(i,this.index+1),new Error("Missing closing curly braces: "+(this.componentName?"Component -> "+this.componentName+",":"")+" text -> "+this.text.slice(i,this.index+1));o?(null!=t&&(t-=1),a+=h,this.index+=1):(null!=t&&(t-=1),n+=h,a+=h,this.index+=1)}}if(n)if("false"===n||"true"===n||"NaN"===n||"null"===n||"undefined"===n)n="";else{var d=n.trim();-1===e.indexOf(d)&&e.push(d),n=""}return{startIndex:i,vars:e,exp:a}},e.makeToken=function(t,e,n){return{parsingMode:n||this.parsingMode,contextMode:this.contextMode,rawValue:t,startIndex:e,endIndex:this.index-1,lineNumber:this.currentLineNumber,parentToken:this.contextMode===h?this.relationsMap[this.relationsMap.length-1]:null,componentName:this.componentName,attrs:null,component:null}},e.vizError=function(t,e){var n;if("object"==typeof document&&(n=document.querySelector("body"))){var i="<pre>"+this.text.slice(0,t)+'<b style="color:orangered">'+this.text.slice(t,e)+"</b></pre>";n.innerHTML=i}},t}(),p=n(2),m={didMounts:[],willUnmounts:[],appInstance:null,history:n.n(p)()()},x=function(){function t(){}var e=t.prototype;return e.build=function(t){var e=this;if(void 0===t&&(t=[]),this.tokens=t,this.vnt=[],this.tokensLength=this.tokens.length,this.tokensLength>0)return this.tokens.forEach(function(t){if(t.parentToken){var n=t.parentToken.children;n?n.push(t):t.parentToken.children=[t]}else e.vnt.push(t)}),this.vnt.length>1?this.vnt:this.vnt[0];throw new Error("VNT error: not enough tokens")},e.compile=function(t){if("[object Object]"===Object.prototype.toString.call(t))return this._compile(t);if("[object Array]"===Object.prototype.toString.call(t))throw new Error("VNT error: got more than 1 entry point")},e._compile=function(t){var e=this,n=t.rawValue,r=t.attrs,s=t.children,a=t.parsingMode,h=t.component,u=a(n);return h&&(h._setDOM(u),u._component=h,"function"==typeof h.didMount&&m.didMounts.push(h.didMount.bind(h))),a===i&&(u._tag=n),r?(o(u,r.rawValue),u._attrs=r.rawValue):u._attrs={},s&&s.forEach(function(t){return u.appendChild(e._compile(t))}),u},t}(),v=function(t){return function(e){return t._compile(e)}}(new x);function g(){if(m.didMounts.length){var t=m.didMounts.slice();m.didMounts=[],t.forEach(function(t){return t()})}}function y(t,e){w(t),function(){if(m.willUnmounts.length){var t=m.willUnmounts.slice();m.willUnmounts=[];for(var e=t.length-1;e>-1;e--)t[e]()}}(),e||t.remove()}function w(t){if(3!==t.nodeType)return 1===t.nodeType&&!t._component&&t.childNodes.length?b(t.childNodes):void(1===t.nodeType&&t._component&&t._component.willUnmount&&(m.willUnmounts.push(t._component.willUnmount.bind(t._component)),t.childNodes.length&&b(t.childNodes)))}function b(t){for(var e=0,n=t.length;e<n;)w(t[e]),e++}function E(t,e,n){var i=v(t);return y(e,!0),n.replaceChild(i,e),i}function M(t,e){if("function"==typeof t){var n;if(n=new t,m.appInstance=n,!n._isHybridButterflyComponent)throw new Error(t.name+" must extend Component");var i=new f,r=new x;if(!e||!e||!e.appendChild)throw new Error("render second argument must be a DOM element");return e.appendChild(r.compile(r.build(i.lex(n.template(),n,t.name)))),void g()}throw new Error("render first argument must be a class/constructor")}function k(){this.components={},this._isHybridButterflyComponent=!0}k.prototype.updateView=function(){var t=new f,e=new x,n=this.template();!function t(e,n,i){if(n&&null!=e)if(1===n.nodeType){if(e.rawValue!==n._tag)return E(e,n,i);if(e.component&&n._component){if(e.component.constructor.name!==n._component.constructor.name)return E(e,n,i);n._component=Object.assign(e.component,n._component),n._component._setDOM(n)}else if(e.component||n._component)return E(e,n,i);if(function(t,e){var n=t.attrs?t.attrs.rawValue:{};!function(t,e,n){for(var i in e)if("_eventsMap"===i)for(var r in e._eventsMap)n.removeEventListener(r,e._eventsMap[r]);else i in t||n.removeAttribute(i)}(n,e._attrs,e),function(t,e,n){for(var i in t)if("_eventsMap"===i)for(var r in t._eventsMap)n.addEventListener(r,t._eventsMap[r]);else e[i]!==t[i]&&n.setAttribute(i,t[i])}(n,e._attrs,e),e._attrs=n}(e,n),e.children)for(var o=0;o<e.children.length;o++)t(e.children[o],n.childNodes[o],n);var s=n.childNodes.length,a=e.children?e.children.length:0;if(s>a)for(;s-- >a;)y(n.childNodes[s])}else{if(3!==n.nodeType||e.parsingMode!==r)return E(e,n,i);e.rawValue!==n.nodeValue&&(n.nodeValue=e.rawValue)}else null==n&&e&&i.appendChild(v(e))}(e.build(t.lex(n,this,this.constructor.name)),this.DOM,this.DOM.parentNode),g()},k.prototype._setRouterMatch=function(t){this.routerMatch=t},k.prototype._setDOM=function(t){this.DOM=t};var _=n(3),O=n.n(_);function N(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}m.history.listen(function(){m.appInstance.updateView()});var C=function(t){var e=t.path,n=t.component,i=t.exact,r=t.data,o=m.history.location.pathname,s=[],a=O()(e,s).exec(o);if(a){var h;if(a.length>1){var u=s.map(function(t){return t.name}),c=a.slice(1);h=u.reduce(function(t,e,n){return t[e]=c[n],t},{})}var l=new n(r);return l._setRouterMatch(h),l}return o.startsWith(e)&&!i?new n(r):{}},L=function(t){function e(e,n){var i;return(i=t.call(this)||this).text=e,i.path=n,i.navigate=i.navigate.bind(N(N(i))),i}!function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}(e,t);var n=e.prototype;return n.navigate=function(){m.history.push(this.path)},n.template=function(){return'a(href="javascript:;",@click="navigate()")["'+this.text+'"]'},e}(k);n.d(e,"Component",function(){return k}),n.d(e,"render",function(){return M}),n.d(e,"RouterLink",function(){return L}),n.d(e,"RouterView",function(){return C})}])});